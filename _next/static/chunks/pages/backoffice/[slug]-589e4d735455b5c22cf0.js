(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[310],{6885:function(e,t,n){"use strict";n.r(t);var r=n(2809),s=n(8017),o=n(7086),i=n(7302),c=n(1033),a=n(9345),l=n(336),u=n(4115),d=n(980),h=n(6034),f=n(6729),m=n(6618),g=n(9887),p=n(17),j=n(8906),x=n(1163),b=n(7294),v=n(5893);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(){var e,t=(0,x.useRouter)().query.slug,n=(0,b.useState)({}),w=n[0],O=n[1],S=(0,b.useState)(!1),P=S[0],C=S[1],k=(0,b.useState)({isVisible:!1,status:"info",title:"",message:""}),_=k[0],z=k[1];(0,b.useEffect)((function(){if(t){var e=""+"/api/articles/".concat(t);fetch(e).then((function(e){return e.json()})).then((function(e){O(e),C(!0)})).catch((function(e){return console.error(e)}))}}),[t]);var T=function(e,t,n){z({isVisible:!0,status:e,title:t,message:n})},E=function(e){var t=y({},w),n=y({},w.meta);"content"==e.currentTarget.id?t.content=e.currentTarget.value:"slug"==e.currentTarget.id?t.slug=e.currentTarget.value:n=y(y({},n),{},(0,r.Z)({},e.currentTarget.id,e.currentTarget.value)),O(y(y({},t),{},{meta:n}))};return(0,v.jsx)(s.xu,{mt:[10,0],children:(0,v.jsxs)(o.M,{display:{base:"initial",md:"grid"},columns:{md:3},spacing:{md:6},children:[_.isVisible&&(0,v.jsxs)(i.bZ,{status:_.status,children:[(0,v.jsx)(i.zM,{}),(0,v.jsxs)(s.xu,{flex:"1",children:[(0,v.jsx)(i.Cd,{children:_.title}),(0,v.jsx)(i.X,{display:"block",children:_.message})]}),(0,v.jsx)(c.P,{position:"absolute",right:"8px",top:"8px",onClick:function(){z({isVisible:!1,status:"info",title:"",message:""})}})]}),(0,v.jsx)(a.P,{colSpan:{md:1},children:(0,v.jsxs)(s.xu,{px:[4,0],children:[(0,v.jsx)(l.X,{fontSize:"lg",fontWeight:"medium",lineHeight:"6",children:"Agenda"}),(0,v.jsx)(u.x,{mt:1,fontSize:"sm"})]})}),(0,v.jsx)(a.P,{mt:[5,null,0],colSpan:{md:2},children:(0,v.jsxs)(d.chakra.form,{method:"POST",shadow:"base",rounded:[null,"md"],overflow:{sm:"hidden"},children:[P&&(0,v.jsxs)(h.Kq,{px:4,py:5,p:[null,6],spacing:6,children:[(0,v.jsxs)(o.M,{columns:6,spacing:6,children:[(0,v.jsxs)(f.NI,{as:a.P,colSpan:[6,3],children:[(0,v.jsx)(m.l,{htmlFor:"slug",fontSize:"sm",fontWeight:"md",children:"Filename"}),(0,v.jsx)(g.I,{type:"text",name:"slug",id:"slug",autoComplete:"given-name",mt:1,focusBorderColor:"brand.400",shadow:"sm",size:"sm",w:"full",rounded:"md",value:w.slug,onChange:E})]}),Object.keys(null!==(e=null===w||void 0===w?void 0:w.meta)&&void 0!==e?e:{}).map((function(e,t){var n,r=null!==(n=null===w||void 0===w?void 0:w.meta[e])&&void 0!==n?n:"";return(0,v.jsxs)(f.NI,{as:a.P,colSpan:[6,3],children:[(0,v.jsx)(m.l,{htmlFor:e,fontSize:"sm",fontWeight:"md",children:e}),(0,v.jsx)(g.I,{type:"text",name:e,id:e,autoComplete:"given-name",mt:1,focusBorderColor:"brand.400",shadow:"sm",size:"sm",w:"full",rounded:"md",value:r,onChange:E})]},t)}))]}),(0,v.jsx)(o.M,{children:(0,v.jsxs)(f.NI,{id:"content",mt:1,children:[(0,v.jsx)(m.l,{fontSize:"sm",fontWeight:"md",children:"Content"}),(0,v.jsx)(p.g,{id:"content",name:"content",mt:1,rows:20,shadow:"sm",focusBorderColor:"brand.400",fontSize:{sm:"sm"},value:w.content,onChange:E}),(0,v.jsx)(f.Q6,{children:"Content with Markdown format."})]})})]}),(0,v.jsx)(s.xu,{px:{base:4,sm:6},py:3,textAlign:"right",children:(0,v.jsx)(j.z,{colorScheme:"purple",_focus:{shadow:""},fontWeight:"md",onClick:function(){var e=y({},w);fetch("/api/articles/update",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){if(e.ok){var n=t===w.slug?"S'ha actualitzat correctament el registre.":"S'ha canviat el nom del registre i si no hi havia cap amb aquest nom, s'ha creat un nou registre.";T("success","Registre guardat",n)}else T("error","Error no esperat!",JSON.stringify(e)),console.log(e)})).catch((function(e){console.error(e),T("error","Error no esperat!",e.toString())}))},children:"Update"})})]})})]})})}},8654:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backoffice/[slug]",function(){return n(6885)}])}},function(e){e.O(0,[291,185,774,888,179],(function(){return t=8654,e(e.s=t);var t}));var t=e.O();_N_E=t}]);